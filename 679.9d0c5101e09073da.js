"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[679],{7679:(D,h,n)=>{n.r(h),n.d(h,{ServicesModule:()=>ee});var _=n(4521),d=n(3075),m=n(8966),g=n(7579),u=n(2722),e=n(5e3),f=n(7550),b=n(1937),p=n(7322),x=n(7531),c=n(9808),C=n(4102),l=n(508),r=n(7423);function O(i,s){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es requerido. "),e.qZA())}function E(i,s){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es requerido. "),e.qZA())}function U(i,s){if(1&i&&(e.TgZ(0,"mat-option",10),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.Q6J("value",t.enabled),e.xp6(1),e.Oqu(t.description)}}function M(i,s){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es requerido. "),e.qZA())}function J(i,s){if(1&i&&(e.TgZ(0,"mat-form-field")(1,"mat-select",8),e.YNc(2,U,2,2,"mat-option",9),e.qZA(),e.YNc(3,M,2,0,"mat-error",3),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.statuses),e.xp6(1),e.Q6J("ngIf",t.form.get("enabled").invalid&&t.form.get("enabled").touched)}}function N(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){return e.CHM(t),e.oxw().onCreateService()}),e._uU(1," Crear servicio "),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("color","primary")("disabled",t.form.invalid||t.form.pristine)}}function k(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){return e.CHM(t),e.oxw().onUpdateService()}),e._uU(1," Actualizar servicio "),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("color","primary")("disabled",t.form.invalid||t.form.pristine)}}let Z=(()=>{class i{constructor(t,o,a,v,I){this.data=t,this._fb=o,this._service=a,this._snackbar=v,this._dialog=I,this.newService=!0,this._unsubscribeAll=new g.x,this.statuses=[{id:0,enabled:!1,description:"Inhabilitado"},{id:1,enabled:!0,description:"Habilitado"}]}ngOnInit(){this._initForm(),this._onSetService()}_initForm(){this.form=this._fb.group({id:[""],enabled:[],createdAt:[""],name:["",[d.kI.required]],budget:["",[d.kI.required]]})}_setForm(t){this.form.patchValue({id:t.id,name:t.Name,budget:null==t?void 0:t.Price,enabled:t.IsEnabled,createdAt:t.CreatedAt})}onCreateService(){if(this.form.invalid)return Object.values(this.form.controls).forEach(t=>t.markAsTouched());this._service.createService(this.form.value).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{let o="Ha ocurrido un error al crear el servicio.";o=400===t?"Ya existe un servicio con ese nombre.":"Se ha creado el servicio de manera correcta",this._snackbar.open(o),400!==t&&this.onCancel()})}onUpdateService(){if(this.form.invalid)return Object.values(this.form.controls).forEach(t=>t.markAsTouched());this._service.updateService(this.form.value).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this._snackbar.open(200==t?"Se ha actualizado el servicio de manera correcta":"Ha ocurrido un error al actualizar el servicio."),this.onCancel()})}onKeyDown(t){"Space"===t.code&&t.target.value.endsWith(" ")&&t.preventDefault()}onKeyDownAmount(t){if("Space"===t.code)return t.preventDefault()}onCancel(){return this._dialog.close()}_onSetService(){(null==this?void 0:this.data)&&(this.newService=!1,this._setForm(null==this?void 0:this.data))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m.WI),e.Y36(d.qu),e.Y36(f.r),e.Y36(b.cw),e.Y36(m.so))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-dialog"]],decls:15,vars:6,consts:[["mat-dialog-title",""],["name","form",3,"formGroup"],["matInput","","formControlName","name","placeholder","Descripci\xf3n del servicio",3,"keydown"],[4,"ngIf"],["matInput","","formControlName","budget","placeholder","Monto del servicio",3,"keydown"],["mat-dialog-actions",""],["mat-button","","type","button",3,"click"],["type","button","mat-flat-button","",3,"color","disabled","click",4,"ngIf"],["placeholder","Estado","formControlName","enabled"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","button","mat-flat-button","",3,"color","disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"h2",0),e._uU(1,"Informaci\xf3n del servicio"),e.qZA(),e.TgZ(2,"form",1)(3,"mat-form-field")(4,"input",2),e.NdJ("keydown",function(v){return o.onKeyDown(v)}),e.qZA(),e.YNc(5,O,2,0,"mat-error",3),e.qZA(),e.TgZ(6,"mat-form-field")(7,"input",4),e.NdJ("keydown",function(v){return o.onKeyDownAmount(v)}),e.qZA(),e.YNc(8,E,2,0,"mat-error",3),e.qZA(),e.YNc(9,J,4,2,"mat-form-field",3),e.TgZ(10,"div",5)(11,"button",6),e.NdJ("click",function(){return o.onCancel()}),e._uU(12,"Cancelar"),e.qZA(),e.YNc(13,N,2,2,"button",7),e.YNc(14,k,2,2,"button",7),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("ngIf",o.form.get("name").invalid&&o.form.get("name").touched),e.xp6(3),e.Q6J("ngIf",o.form.get("budget").invalid&&o.form.get("budget").touched),e.xp6(1),e.Q6J("ngIf",!o.newService),e.xp6(4),e.Q6J("ngIf",o.newService),e.xp6(1),e.Q6J("ngIf",!o.newService))},directives:[m.uh,d._Y,d.JL,d.sg,p.KE,x.Nt,d.Fj,d.JJ,d.u,c.O5,p.TO,C.gD,c.sg,l.ey,m.H8,r.lW],styles:[".mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:10px;display:grid!important}"]}),i})();var S=n(5245),T=n(6087),y=n(4847),Q=n(6451),w=n(3900),F=n(4004),A=n(7238);function Y(i,s){1&i&&e._UZ(0,"mat-icon",14),2&i&&e.Q6J("matTooltip","Inhabilitado")}function L(i,s){1&i&&e._UZ(0,"mat-icon",15),2&i&&e.Q6J("matTooltip","Habilitado")}function P(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",6)(2,"div",7)(3,"div",8),e._uU(4),e.qZA()(),e.TgZ(5,"div",9),e._uU(6),e.qZA(),e.TgZ(7,"div",9),e._uU(8),e.ALo(9,"currency"),e.qZA(),e.TgZ(10,"div",9),e.YNc(11,Y,1,1,"mat-icon",10),e.YNc(12,L,1,1,"mat-icon",11),e.qZA(),e.TgZ(13,"div")(14,"button",12),e.NdJ("click",function(){const v=e.CHM(t).$implicit;return e.oxw(3).openDialog(v)}),e._UZ(15,"mat-icon",13),e.qZA()()(),e.BQk()}if(2&i){const t=s.$implicit;e.xp6(4),e.hij(" ",null==t?null:t.id," "),e.xp6(2),e.hij(" ",null==t?null:t.Name," "),e.xp6(2),e.hij(" ",e.gM2(9,5,null==t?null:t.Price,"GTQ","symbol","1.2-2")," "),e.xp6(3),e.Q6J("ngIf",!(null!=t&&t.IsEnabled)),e.xp6(1),e.Q6J("ngIf",null==t?null:t.IsEnabled)}}function R(i,s){if(1&i&&(e.ynx(0),e.YNc(1,P,16,10,"ng-container",5),e.BQk()),2&i){const t=s.ngIf,o=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",o.trackByFn)}}const j=function(i){return{"pointer-events-none":i}};function B(i,s){if(1&i&&(e.ynx(0),e.TgZ(1,"div",1)(2,"div",2),e._UZ(3,"div",3),e.TgZ(4,"div"),e._uU(5,"Descripci\xf3n"),e.qZA(),e.TgZ(6,"div"),e._uU(7,"Monto establecido"),e.qZA(),e.TgZ(8,"div"),e._uU(9,"Estado"),e.qZA(),e.TgZ(10,"div"),e._uU(11,"Opciones"),e.qZA()(),e.YNc(12,R,2,2,"ng-container",0),e.ALo(13,"async"),e.qZA(),e._UZ(14,"mat-paginator",4),e.BQk()),2&i){const t=e.oxw();e.xp6(12),e.Q6J("ngIf",e.lcZ(13,4,t.services$)),e.xp6(2),e.Q6J("ngClass",e.VKq(6,j,t.loading))("length",t.count)("pageSizeOptions",t.pageSizeOptions)}}function z(i,s){1&i&&(e.ynx(0),e.TgZ(1,"div",16),e._UZ(2,"mat-icon",17),e.TgZ(3,"div",18),e._uU(4," No se han encontrado servicios. "),e.qZA()(),e.BQk()),2&i&&(e.xp6(2),e.Q6J("svgIcon","mat_outline:receipt_long"))}let H=(()=>{class i{constructor(t,o,a){this._dialog=t,this._cdr=o,this._service=a,this._unsubscribeAll=new g.x,this.pageSize=10,this.page=1,this.count=0,this.pages=0,this.pageSizeOptions=[10,15,25],this.services=[],this._unsubscribeAll=new g.x}ngOnInit(){this._getServices(),this._onListenDialog()}ngAfterViewInit(){this.sort&&this.paginator&&(this.sort.sort({id:"id",start:"asc",disableClear:!0}),this._cdr.markForCheck(),(0,Q.T)(this.sort.sortChange,this.paginator.page).pipe((0,w.w)(()=>(this.loading=!0,this.pageSize=this.paginator.pageSize,this._service.findServices({page:this.paginator.pageIndex+1,pageSize:this.paginator.pageSize}))),(0,F.U)(()=>this.loading=!1)).pipe((0,u.R)(this._unsubscribeAll)).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}openDialog(t){this._dialog.open(Z,{width:"500px",data:t}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(a=>{this._getServices()})}_getServices(t=1,o=10){this.loading=!0,this._service.findServices({page:t,pageSize:o}).pipe((0,u.R)(this._unsubscribeAll)).subscribe(a=>{this.page=a.page,this.loading=!1,this.count=a.total,this.pages=a.pages,this.services=null==a?void 0:a.services,this._cdr.markForCheck()}),this.services$=this._service.services$}_onListenDialog(){this._service.onDialog.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this._getServices()})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m.uw),e.Y36(e.sBO),e.Y36(f.r))},i.\u0275cmp=e.Xpm({type:i,selectors:[["services-list"]],viewQuery:function(t,o){if(1&t&&(e.Gf(T.NW,5),e.Gf(y.YE,5)),2&t){let a;e.iGM(a=e.CRH())&&(o.paginator=a.first),e.iGM(a=e.CRH())&&(o.sort=a.first)}},decls:2,vars:2,consts:[[4,"ngIf"],[1,"grid"],["matSort","","matSortDisableClear","",1,"inventory-grid-report","z-10","sticky","top-0","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"hidden","sm:block"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageSizeOptions"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"inventory-grid-report","grid","items-center","gap-4","py-3","px-6","md:px-8","border-b"],[1,"flex","items-center"],[1,"relative","flex","flex-0","items-center","justify-center","w-12","h-12","mr-6","rounded","overflow-hidden","border"],[1,"truncate"],["style","color: red","svgIcon","heroicons_outline:x-circle",3,"matTooltip",4,"ngIf"],["style","color: green","svgIcon","heroicons_outline:check-circle",3,"matTooltip",4,"ngIf"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"click"],["svgIcon","heroicons_outline:pencil-alt"],["svgIcon","heroicons_outline:x-circle",2,"color","red",3,"matTooltip"],["svgIcon","heroicons_outline:check-circle",2,"color","green",3,"matTooltip"],[1,"flex","flex-col","flex-auto","items-center","justify-center",2,"margin-top","17%"],[1,"icon-size-24",3,"svgIcon"],[1,"mt-4","text-2xl","font-semibold","tracking-tight","text-secondary"]],template:function(t,o){1&t&&(e.YNc(0,B,15,8,"ng-container",0),e.YNc(1,z,5,1,"ng-container",0)),2&t&&(e.Q6J("ngIf",o.count),e.xp6(1),e.Q6J("ngIf",!o.count&&!o.loading))},directives:[c.O5,y.YE,c.sg,S.Hw,A.gM,r.lW,T.NW,c.mk],pipes:[c.Ov,c.H9],styles:[".inventory-grid-report[_ngcontent-%COMP%]{grid-template-columns:3.5fr 1.5fr 1fr}@media (min-width: 600px){.inventory-grid-report[_ngcontent-%COMP%]{grid-template-columns:.5fr 2.5fr 2.5fr 2fr 1fr}}@media (min-width: 960px){.inventory-grid-report[_ngcontent-%COMP%]{grid-template-columns:.5fr 2.5fr 2.5fr 2fr 1fr}}@media (min-width: 1280px){.inventory-grid-report[_ngcontent-%COMP%]{grid-template-columns:.5fr 2.5fr 2.5fr 2fr 1fr}}"]}),i})();const K=[{path:"",component:(()=>{class i{constructor(t,o){this._dialog=t,this._service=o}ngOnInit(){}openDialog(){this._dialog.open(Z,{width:"500px"}).afterClosed().subscribe(o=>this._service.dialog())}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m.uw),e.Y36(f.r))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-services"]],decls:12,vars:2,consts:[[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","flex-shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],["mat-flat-button","",1,"ml-4",3,"color","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden","sm:overflow-y-auto"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Servicios"),e.qZA(),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return o.openDialog()}),e._UZ(6,"mat-icon",5),e.TgZ(7,"span",6),e._uU(8,"Agregar"),e.qZA()()()(),e.TgZ(9,"div",7)(10,"div",8),e._UZ(11,"services-list"),e.qZA()()()),2&t&&(e.xp6(5),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:plus"))},directives:[r.lW,S.Hw,H],styles:[""]}),i})()}];let W=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[_.Bz.forChild(K)],_.Bz]}),i})();var $=n(4466),G=n(7446),X=n(2181),V=n(5899),q=n(2368);let ee=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[b.cw],imports:[[$.m,W,r.ot,G.p9,p.lN,S.Ps,x.c,X.Tx,T.TU,V.Cv,l.si,y.JX,C.LD,q.rP,A.AV,m.Is]]}),i})()},7550:(D,h,n)=>{n.d(h,{r:()=>x});var _=n(2340),d=n(7579),m=n(1135),g=n(4004),u=n(262),e=n(9646),f=n(5e3),b=n(520);const p=_.N.base_url;let x=(()=>{class c{constructor(l){this._http=l,this.dialogSubject=new d.x,this._services=new m.X(null)}get services$(){return this._services.asObservable()}createService(l){return this._http.post(`${p}/service/create`,l,this.getHeaders).pipe((0,g.U)(r=>r.statusCode?r.statusCode:500),(0,u.K)(r=>(0,e.of)(r.status)))}updateService(l){return this._http.put(`${p}/service/update`,l,this.getHeaders).pipe((0,g.U)(r=>(null==r?void 0:r.statusCode)?null==r?void 0:r.statusCode:500),(0,u.K)(r=>(console.log(r),(0,e.of)(500))))}findServices(l){return this._http.post(`${p}/service/find`,l,this.getHeaders).pipe((0,g.U)(r=>(null==r?void 0:r.statusCode)&&200==(null==r?void 0:r.statusCode)?(this._services.next(null==r?void 0:r.services),{page:null==r?void 0:r.page,total:r.total,pages:null==r?void 0:r.pages,services:r.services}):null),(0,u.K)(r=>(0,e.of)(null)))}dialog(){this.dialogSubject.next()}get onDialog(){return this.dialogSubject.asObservable()}get getToken(){return localStorage.getItem("x-token")||""}get getHeaders(){return{headers:{"x-token":this.getToken}}}}return c.\u0275fac=function(l){return new(l||c)(f.LFG(b.eN))},c.\u0275prov=f.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()}}]);